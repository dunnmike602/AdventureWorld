<?xml version="1.0" encoding="utf-8"?>
<Root>
  <ConDesigner>
    <DesignerItems>
      <DesignerItem>
        <Left>0</Left>
        <Top>50</Top>
        <Width>130</Width>
        <Height>90</Height>
        <ID>74b62482-ab1b-4879-a87e-11e1342e54df</ID>
        <zIndex>0</zIndex>
        <IsGroup>false</IsGroup>
        <ParentId>00000000-0000-0000-0000-000000000000</ParentId>
        <Content>&lt;Grid Name="StartGrid" ToolTip="ConversationStart" IsHitTestVisible="False" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"&gt;&lt;Border BorderThickness="1,1,1,1" BorderBrush="#FF000000"&gt;&lt;Grid Background="#FFFFF8DC"&gt;&lt;Grid.RowDefinitions&gt;&lt;RowDefinition Height="*" /&gt;&lt;RowDefinition Height="2.7*" /&gt;&lt;/Grid.RowDefinitions&gt;&lt;Border Background="#FF0000FF" Grid.Row="0"&gt;&lt;TextBlock Text="Start" FontWeight="Bold" Foreground="#FFFFFFFF" TextTrimming="WordEllipsis" TextWrapping="Wrap" Margin="2,2,2,2" HorizontalAlignment="Left" VerticalAlignment="Top" /&gt;&lt;/Border&gt;&lt;TextBlock Text="CONVERSATION1" Foreground="#FF000000" TextTrimming="CharacterEllipsis" TextWrapping="Wrap" Name="StartText" Margin="2,2,2,2" HorizontalAlignment="Left" VerticalAlignment="Top" ToolTip="CONVERSATION1" Grid.Row="1" /&gt;&lt;/Grid&gt;&lt;/Border&gt;&lt;/Grid&gt;</Content>
        <StencilObjectType>ConversationStart</StencilObjectType>
      </DesignerItem>
      <DesignerItem>
        <Left>300</Left>
        <Top>50</Top>
        <Width>130</Width>
        <Height>90</Height>
        <ID>9253d2a4-e82d-4879-82a2-3e082565268b</ID>
        <zIndex>3</zIndex>
        <IsGroup>false</IsGroup>
        <ParentId>00000000-0000-0000-0000-000000000000</ParentId>
        <Content>&lt;Grid Name="TextGrid" ToolTip="ConversationText" IsHitTestVisible="False" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"&gt;&lt;Border BorderThickness="1,1,1,1" BorderBrush="#FF000000"&gt;&lt;Grid Background="#FFFFF8DC"&gt;&lt;Grid.RowDefinitions&gt;&lt;RowDefinition Height="*" /&gt;&lt;RowDefinition Height="2.7*" /&gt;&lt;/Grid.RowDefinitions&gt;&lt;Border Background="#FFDC143C" Grid.Row="0"&gt;&lt;TextBlock Text="NPC Speaks" FontWeight="Bold" Foreground="#FFFFFFFF" TextTrimming="WordEllipsis" TextWrapping="Wrap" Margin="2,2,2,2" HorizontalAlignment="Left" VerticalAlignment="Top" /&gt;&lt;/Border&gt;&lt;TextBlock Text="Greetings, you are authorised to use my services. Please select one." Foreground="#FF000000" TextTrimming="CharacterEllipsis" TextWrapping="Wrap" Name="Text" Margin="2,2,2,2" HorizontalAlignment="Left" VerticalAlignment="Top" ToolTip="Greetings, you are authorised to use my services. Please select one." Grid.Row="1" /&gt;&lt;/Grid&gt;&lt;/Border&gt;&lt;/Grid&gt;</Content>
        <StencilObjectType>ConversationText</StencilObjectType>
      </DesignerItem>
      <DesignerItem>
        <Left>600</Left>
        <Top>50</Top>
        <Width>130</Width>
        <Height>90</Height>
        <ID>87304e76-adb1-4bc7-a1e0-8838f6e96b10</ID>
        <zIndex>4</zIndex>
        <IsGroup>false</IsGroup>
        <ParentId>00000000-0000-0000-0000-000000000000</ParentId>
        <Content>&lt;Grid Name="ResponseGrid" ToolTip="ConversationResponse" IsHitTestVisible="False" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"&gt;&lt;Border BorderThickness="1,1,1,1" BorderBrush="#FF000000"&gt;&lt;Grid Background="#FFFFF8DC"&gt;&lt;Grid.RowDefinitions&gt;&lt;RowDefinition Height="*" /&gt;&lt;RowDefinition Height="2.7*" /&gt;&lt;/Grid.RowDefinitions&gt;&lt;Border Background="#FF2F4F4F" Grid.Row="0"&gt;&lt;Grid&gt;&lt;Grid.ColumnDefinitions&gt;&lt;ColumnDefinition Width="*" /&gt;&lt;ColumnDefinition Width="Auto" /&gt;&lt;/Grid.ColumnDefinitions&gt;&lt;TextBlock Text="Player Responds" FontWeight="Bold" Foreground="#FFFFFFFF" TextTrimming="WordEllipsis" TextWrapping="Wrap" Margin="2,2,2,2" HorizontalAlignment="Left" VerticalAlignment="Top" Grid.Column="0" /&gt;&lt;Border BorderThickness="1,1,1,1" Padding="2,2,2,2" BorderBrush="#FF000000" Background="#FFFFFFFF" Grid.Column="1"&gt;&lt;Border.Style&gt;&lt;Style TargetType="Border"&gt;&lt;Style.Triggers&gt;&lt;DataTrigger Binding="{Binding Path=Text, ElementName=SortOrder}" Value=""&gt;&lt;Setter Property="UIElement.Visibility"&gt;&lt;Setter.Value&gt;&lt;x:Static Member="Visibility.Collapsed" /&gt;&lt;/Setter.Value&gt;&lt;/Setter&gt;&lt;/DataTrigger&gt;&lt;DataTrigger Binding="{Binding Path=Text, ElementName=SortOrder}" Value="{x:Null}"&gt;&lt;Setter Property="UIElement.Visibility"&gt;&lt;Setter.Value&gt;&lt;x:Static Member="Visibility.Collapsed" /&gt;&lt;/Setter.Value&gt;&lt;/Setter&gt;&lt;/DataTrigger&gt;&lt;/Style.Triggers&gt;&lt;Style.Resources&gt;&lt;ResourceDictionary /&gt;&lt;/Style.Resources&gt;&lt;/Style&gt;&lt;/Border.Style&gt;&lt;TextBlock Text="0" Foreground="#FF000000" Name="SortOrder" HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Row="1"&gt;&lt;TextBlock.ToolTip&gt;&lt;s:Int32&gt;0&lt;/s:Int32&gt;&lt;/TextBlock.ToolTip&gt;&lt;/TextBlock&gt;&lt;/Border&gt;&lt;/Grid&gt;&lt;/Border&gt;&lt;TextBlock Text="Open the cupboard door at the end of the corridor" Foreground="#FF000000" TextTrimming="CharacterEllipsis" TextWrapping="Wrap" Name="Response" Margin="2,2,2,2" HorizontalAlignment="Left" VerticalAlignment="Top" ToolTip="Open the cupboard door at the end of the corridor" Grid.Row="1" /&gt;&lt;/Grid&gt;&lt;/Border&gt;&lt;/Grid&gt;</Content>
        <StencilObjectType>ConversationResponse</StencilObjectType>
      </DesignerItem>
      <DesignerItem>
        <Left>600</Left>
        <Top>200</Top>
        <Width>130</Width>
        <Height>90</Height>
        <ID>2f757c6f-5b74-4876-b761-1f00a26b5572</ID>
        <zIndex>5</zIndex>
        <IsGroup>false</IsGroup>
        <ParentId>00000000-0000-0000-0000-000000000000</ParentId>
        <Content>&lt;Grid Name="TextGrid" ToolTip="ConversationText" IsHitTestVisible="False" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"&gt;&lt;Border BorderThickness="1,1,1,1" BorderBrush="#FF000000"&gt;&lt;Grid Background="#FFFFF8DC"&gt;&lt;Grid.RowDefinitions&gt;&lt;RowDefinition Height="*" /&gt;&lt;RowDefinition Height="2.7*" /&gt;&lt;/Grid.RowDefinitions&gt;&lt;Border Background="#FFDC143C" Grid.Row="0"&gt;&lt;TextBlock Text="NPC Speaks" FontWeight="Bold" Foreground="#FFFFFFFF" TextTrimming="WordEllipsis" TextWrapping="Wrap" Margin="2,2,2,2" HorizontalAlignment="Left" VerticalAlignment="Top" /&gt;&lt;/Border&gt;&lt;TextBlock Text="Certainly! Please wait and I will attend to it immediately.&amp;#xA;&amp;#xA;With a whoosh of compressed air the Robot trundles off and disappears down the corridor, leaving you in silence." Foreground="#FF000000" TextTrimming="CharacterEllipsis" TextWrapping="Wrap" Name="Text" Margin="2,2,2,2" HorizontalAlignment="Left" VerticalAlignment="Top" ToolTip="Certainly! Please wait and I will attend to it immediately.&amp;#xA;&amp;#xA;With a whoosh of compressed air the Robot trundles off and disappears down the corridor, leaving you in silence." Grid.Row="1" /&gt;&lt;/Grid&gt;&lt;/Border&gt;&lt;/Grid&gt;</Content>
        <StencilObjectType>ConversationText</StencilObjectType>
      </DesignerItem>
    </DesignerItems>
    <Connections>
      <Connection>
        <SourceID>74b62482-ab1b-4879-a87e-11e1342e54df</SourceID>
        <SinkID>9253d2a4-e82d-4879-82a2-3e082565268b</SinkID>
        <SourceConnectorName>Right</SourceConnectorName>
        <SinkConnectorName>Left</SinkConnectorName>
        <SourceArrowSymbol>None</SourceArrowSymbol>
        <SinkArrowSymbol>Arrow</SinkArrowSymbol>
        <zIndex>1</zIndex>
        <ID>15a2f094-adbe-46d4-bef9-7f95defd2397</ID>
      </Connection>
      <Connection>
        <SourceID>9253d2a4-e82d-4879-82a2-3e082565268b</SourceID>
        <SinkID>87304e76-adb1-4bc7-a1e0-8838f6e96b10</SinkID>
        <SourceConnectorName>Right</SourceConnectorName>
        <SinkConnectorName>Left</SinkConnectorName>
        <SourceArrowSymbol>None</SourceArrowSymbol>
        <SinkArrowSymbol>Arrow</SinkArrowSymbol>
        <zIndex>2</zIndex>
        <ID>bf401734-9dda-4cc7-a835-69986a60951a</ID>
      </Connection>
      <Connection>
        <SourceID>87304e76-adb1-4bc7-a1e0-8838f6e96b10</SourceID>
        <SinkID>2f757c6f-5b74-4876-b761-1f00a26b5572</SinkID>
        <SourceConnectorName>Bottom</SourceConnectorName>
        <SinkConnectorName>Top</SinkConnectorName>
        <SourceArrowSymbol>None</SourceArrowSymbol>
        <SinkArrowSymbol>Arrow</SinkArrowSymbol>
        <zIndex>6</zIndex>
        <ID>5418efab-939c-480b-a867-7aec7c931112</ID>
      </Connection>
    </Connections>
  </ConDesigner>
  <DataObjects>
    <Conversations>&lt;ArrayOfConversation xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.datacontract.org/2004/07/DiagramDesigner.AdventureWorld.Domain"&gt;&lt;Conversation z:Id="i1" xmlns:z="http://schemas.microsoft.com/2003/10/Serialization/"&gt;&lt;ControlId&gt;74b62482-ab1b-4879-a87e-11e1342e54df&lt;/ControlId&gt;&lt;BaseName&gt;CONVERSATION1&lt;/BaseName&gt;&lt;Descriptions xmlns:d3p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" i:nil="true" /&gt;&lt;ImagePath i:nil="true" /&gt;&lt;ObjectPreprocessScript xmlns:d3p1="http://schemas.datacontract.org/2004/07/AdventureLandCore.Domain"&gt;&lt;d3p1:Id&gt;eaf99ccc-974b-4c86-bd53-4ca0eb8eea10&lt;/d3p1:Id&gt;&lt;d3p1:Source&gt;# This is a template for an AdventureObject pre-process command. AdventureObjects are Rooms, Exits, Containers and PlaceableObjects. Whenever a command is run against 
# one of these types types, this script is executed. It can be used to perform custom actions whenever the player interacts with something. 

# The commented out code below illustrates how to use this for a room object to switch between dark and light descriptions.
def Execute(adventureObject, adventureCommand):
	## Pre-requisite ensure the rooms has 2 descriptions, the first one for a lit condition, the second for a dark condition
	## You can set them up in the game designer or code them directly here

	##if adventureCommand.CommandMapping.VerbName == "LOOK":
	#	if adventureObject.IsDark:
	#		adventureObject.CurrentDescription = adventureObject.Descriptions[1]
	#	else:
	#		adventureObject.CurrentDescription = adventureObject.Descriptions[0]
	#
	## We want processing to continue whatever happens so set the flag to True (False ensures no further processing is done by the game engine)

	return True
	&lt;/d3p1:Source&gt;&lt;/ObjectPreprocessScript&gt;&lt;ShowRandomDescription&gt;false&lt;/ShowRandomDescription&gt;&lt;_raiseNotifications&gt;true&lt;/_raiseNotifications&gt;&lt;ConversationPreprocessScript xmlns:d3p1="http://schemas.datacontract.org/2004/07/AdventureLandCore.Domain"&gt;&lt;d3p1:Id&gt;6eaa8a96-00f7-4ad6-8876-a0546d39f331&lt;/d3p1:Id&gt;&lt;d3p1:Source /&gt;&lt;/ConversationPreprocessScript&gt;&lt;ConversationText z:Id="i2"&gt;&lt;ControlId&gt;9253d2a4-e82d-4879-82a2-3e082565268b&lt;/ControlId&gt;&lt;BaseName i:nil="true" /&gt;&lt;Descriptions xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" i:nil="true" /&gt;&lt;ImagePath i:nil="true" /&gt;&lt;ObjectPreprocessScript xmlns:d4p1="http://schemas.datacontract.org/2004/07/AdventureLandCore.Domain"&gt;&lt;d4p1:Id&gt;467d1907-fe52-47c3-9d28-1df67bd0a9a6&lt;/d4p1:Id&gt;&lt;d4p1:Source&gt;# This is a template for an AdventureObject pre-process command. AdventureObjects are Rooms, Exits, Containers and PlaceableObjects. Whenever a command is run against 
# one of these types types, this script is executed. It can be used to perform custom actions whenever the player interacts with something. 

# The commented out code below illustrates how to use this for a room object to switch between dark and light descriptions.
def Execute(adventureObject, adventureCommand):
	## Pre-requisite ensure the rooms has 2 descriptions, the first one for a lit condition, the second for a dark condition
	## You can set them up in the game designer or code them directly here

	##if adventureCommand.CommandMapping.VerbName == "LOOK":
	#	if adventureObject.IsDark:
	#		adventureObject.CurrentDescription = adventureObject.Descriptions[1]
	#	else:
	#		adventureObject.CurrentDescription = adventureObject.Descriptions[0]
	#
	## We want processing to continue whatever happens so set the flag to True (False ensures no further processing is done by the game engine)

	return True
	&lt;/d4p1:Source&gt;&lt;/ObjectPreprocessScript&gt;&lt;ShowRandomDescription&gt;false&lt;/ShowRandomDescription&gt;&lt;_raiseNotifications&gt;true&lt;/_raiseNotifications&gt;&lt;ConversationPreprocessScript xmlns:d4p1="http://schemas.datacontract.org/2004/07/AdventureLandCore.Domain"&gt;&lt;d4p1:Id&gt;e8527407-5e75-4bdc-82d2-82f00625cfb5&lt;/d4p1:Id&gt;&lt;d4p1:Source /&gt;&lt;/ConversationPreprocessScript&gt;&lt;ConversationResponses&gt;&lt;ConversationResponse z:Id="i3"&gt;&lt;ControlId&gt;87304e76-adb1-4bc7-a1e0-8838f6e96b10&lt;/ControlId&gt;&lt;BaseName i:nil="true" /&gt;&lt;Descriptions xmlns:d6p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" i:nil="true" /&gt;&lt;ImagePath i:nil="true" /&gt;&lt;ObjectPreprocessScript xmlns:d6p1="http://schemas.datacontract.org/2004/07/AdventureLandCore.Domain"&gt;&lt;d6p1:Id&gt;429c5744-908b-4ea0-a3f4-e20e4eb388e5&lt;/d6p1:Id&gt;&lt;d6p1:Source&gt;# This is a template for an AdventureObject pre-process command. AdventureObjects are Rooms, Exits, Containers and PlaceableObjects. Whenever a command is run against 
# one of these types types, this script is executed. It can be used to perform custom actions whenever the player interacts with something. 

# The commented out code below illustrates how to use this for a room object to switch between dark and light descriptions.
def Execute(adventureObject, adventureCommand):
	## Pre-requisite ensure the rooms has 2 descriptions, the first one for a lit condition, the second for a dark condition
	## You can set them up in the game designer or code them directly here

	##if adventureCommand.CommandMapping.VerbName == "LOOK":
	#	if adventureObject.IsDark:
	#		adventureObject.CurrentDescription = adventureObject.Descriptions[1]
	#	else:
	#		adventureObject.CurrentDescription = adventureObject.Descriptions[0]
	#
	## We want processing to continue whatever happens so set the flag to True (False ensures no further processing is done by the game engine)

	return True
	&lt;/d6p1:Source&gt;&lt;/ObjectPreprocessScript&gt;&lt;ShowRandomDescription&gt;false&lt;/ShowRandomDescription&gt;&lt;_raiseNotifications&gt;true&lt;/_raiseNotifications&gt;&lt;ConversationPreprocessScript xmlns:d6p1="http://schemas.datacontract.org/2004/07/AdventureLandCore.Domain"&gt;&lt;d6p1:Id&gt;ec36086d-b6b1-46c6-9bfa-16e293bb5fb9&lt;/d6p1:Id&gt;&lt;d6p1:Source /&gt;&lt;/ConversationPreprocessScript&gt;&lt;ConversationText z:Id="i4"&gt;&lt;ControlId&gt;2f757c6f-5b74-4876-b761-1f00a26b5572&lt;/ControlId&gt;&lt;BaseName i:nil="true" /&gt;&lt;Descriptions xmlns:d7p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" i:nil="true" /&gt;&lt;ImagePath i:nil="true" /&gt;&lt;ObjectPreprocessScript xmlns:d7p1="http://schemas.datacontract.org/2004/07/AdventureLandCore.Domain"&gt;&lt;d7p1:Id&gt;a76cc772-3486-42c3-a7f9-04c18bf53b7f&lt;/d7p1:Id&gt;&lt;d7p1:Source&gt;# This is a template for an AdventureObject pre-process command. AdventureObjects are Rooms, Exits, Containers and PlaceableObjects. Whenever a command is run against 
# one of these types types, this script is executed. It can be used to perform custom actions whenever the player interacts with something. 

# The commented out code below illustrates how to use this for a room object to switch between dark and light descriptions.
def Execute(adventureObject, adventureCommand):
	## Pre-requisite ensure the rooms has 2 descriptions, the first one for a lit condition, the second for a dark condition
	## You can set them up in the game designer or code them directly here

	##if adventureCommand.CommandMapping.VerbName == "LOOK":
	#	if adventureObject.IsDark:
	#		adventureObject.CurrentDescription = adventureObject.Descriptions[1]
	#	else:
	#		adventureObject.CurrentDescription = adventureObject.Descriptions[0]
	#
	## We want processing to continue whatever happens so set the flag to True (False ensures no further processing is done by the game engine)

	return True
	&lt;/d7p1:Source&gt;&lt;/ObjectPreprocessScript&gt;&lt;ShowRandomDescription&gt;false&lt;/ShowRandomDescription&gt;&lt;_raiseNotifications&gt;true&lt;/_raiseNotifications&gt;&lt;ConversationPreprocessScript xmlns:d7p1="http://schemas.datacontract.org/2004/07/AdventureLandCore.Domain"&gt;&lt;d7p1:Id&gt;111358b1-9e0f-418a-a623-5383272040b7&lt;/d7p1:Id&gt;&lt;d7p1:Source&gt;def Execute(npc, conversationObject, conversationStage):
	
	# Move the Robot
	robot = AWApi.GetNpcFromName(Robot)
	robot.Parent = AWApi.GetRoomFromName(EastCorridor)
	
	# Open the exit
	exit = AWApi.GetExitFromName(EastCorridor, "EAST")
	exit.IsLocked = False
	EastCorridor.CurrentDescriptionIndex = 1
	robot.Conversation = None
	
	return True
	&lt;/d7p1:Source&gt;&lt;/ConversationPreprocessScript&gt;&lt;ConversationResponses /&gt;&lt;Text&gt;Certainly! Please wait and I will attend to it immediately.

With a whoosh of compressed air the Robot trundles off and disappears down the corridor, leaving you in silence.&lt;/Text&gt;&lt;/ConversationText&gt;&lt;Response&gt;Open the cupboard door at the end of the corridor&lt;/Response&gt;&lt;SortOrder&gt;0&lt;/SortOrder&gt;&lt;/ConversationResponse&gt;&lt;/ConversationResponses&gt;&lt;Text&gt;Greetings, you are authorised to use my services. Please select one.&lt;/Text&gt;&lt;/ConversationText&gt;&lt;EscapeText&gt;Quit&lt;/EscapeText&gt;&lt;/Conversation&gt;&lt;/ArrayOfConversation&gt;</Conversations>
  </DataObjects>
</Root>